<!DOCTYPE html>
<html lang="jp">
<head>
    <meta charset="UTF-8">
    <title>入出金登録</title>
</head>
<body>
<form id="specification" th:action="@{'/spec'}" th:object="${specificationGroupForm}" method="post">
    <div th:object="${specificationGroupForm.accountAndBalanceForm}">
        <input id="accountAndBalanceId" name="accountAndBalanceId"
               th:value="*{accountAndBalanceId}"
               type="hidden">
    </div>

    <table>
        <tr>
            <td></td>
            <td th:object="${specificationGroupForm.userForm}">
                <input id="userId" name="userId"
                       th:value="*{userId}" type="hidden" readonly>
            </td>
        </tr>
        <tr>
            <td>入出金日時</td>
            <td>
                <span>
                    <label for="receivingAndPaymentDate"></label>
                    <input id="receivingAndPaymentDate" name="receivingAndPaymentDate"
                           th:value="${specificationGroupForm.receivingAndPaymentDate}"
                           onchange="changedReceivingAndPaymentDate()"
                           type="date">
                </span>
                <span>
                    <label for="receivingAndPaymentTime"></label>
                    <input id="receivingAndPaymentTime" name="receivingAndPaymentTime"
                           th:value="${specificationGroupForm.receivingAndPaymentTime}"
                           onchange="changedReceivingAndPaymentTime()"
                           type="time">
                </span>
            </td>
        </tr>
        <tr>
            <td><label for="shop">お店</label></td>
            <td th:object="${specificationGroupForm.shopId}">
                <th:block th:if="${shop} ne null">
                    <input id="shopId" name="shopId"
                           readonly
                           th:value="${specificationGroupForm.shopId}" type="hidden">
                    <input form="dummy" id="shop" name="shop"
                           readonly
                           th:value="${shop.shopName}" type="text">
                </th:block>
                <th:block th:unless="${shop} ne null">
                    <input id="shopId" name="shopId"
                           readonly th:value="1" type="hidden">
                    <input form="dummy" id="shop" name="shop"
                           readonly type="text">
                </th:block>
                <input form="searchShop" type="submit" value="検　索"/>
            </td>
        </tr>
        <tr>
            <td>入出金区分</td>
            <td>
                <label for="balanceType"></label>
                <select id="balanceType"
                        name="balanceType"
                        onchange="changedBalanceType()"
                        th:field="*{balanceTypeId}">
                    <option th:each="balanceType : ${balanceTypes}"
                            th:value="${balanceType.balanceTypeId}"
                            th:text="${balanceType.balanceTypeName}">
                    </option>
                </select>
            </td>
        </tr>
        <tr>
            <td>出金元</td>
            <td th:object="${accountSource}">
                <th:block th:if="${accountSource.accountSourceId} ne null">
                    <input id="accountSourceId" name="accountSourceId"
                           th:value="*{accountSourceId}"
                           type="hidden" readonly>
                    <label for="accountSourceName"></label>
                    <input id="accountSourceName" name="accountSourceName"
                           th:value="*{accountName}"
                           type="text" readonly>
                </th:block>
                <th:block
                        th:unless="${accountSource.accountSourceId} ne null">
                    <input id="accountSourceId" name="accountSourceId"
                           th:value="1" type="hidden" readonly>
                    <input id="accountSourceName" name="accountSourceName"
                           type="text" readonly>
                </th:block>
                <input form="searchAccountSource" id="accountSourceButton"
                       type="submit" value="検　索"/>
            </td>
        </tr>
        <tr>
            <td>入金先</td>
            <td th:object="${accountDestination}">
                <th:block
                        th:if="${accountDestination.accountDestinationId} ne null">
                    <input id="accountDestinationId" name="accountDestinationId"
                           readonly
                           th:value="${accountDestination.accountDestinationId}" type="hidden">
                    <label for="accountDestinationName"></label>
                    <input id="accountDestinationName" name="accountDestinationName"
                           th:value="${accountDestination.accountName}"
                           type="text" readonly>
                </th:block>
                <th:block
                        th:unless="${accountDestination.accountDestinationId} ne null">
                    <input id="accountDestinationId" name="accountDestinationId"
                           readonly th:value="1" type="hidden">
                    <input id="accountDestinationName" name="accountDestinationName"
                           type="text" readonly>
                </th:block>
                <input form="searchAccountDestination" id="accountDestinationButton"
                       type="submit" value="検　索"/>
            </td>
        </tr>
        <tr>
            <td>備考</td>
            <td>
                <label for="memo"></label>
                <textarea id="memo" name="memo" th:field="*{memo}"></textarea>
            </td>
        </tr>
        <tr id="specifications">
            <td></td>
            <td>
            </td>
        </tr>
    </table>
</form>
<table id="specificationTable">
    <tr>
        <th>商品名</th>
        <th>単価</th>
        <th>単位</th>
        <th>数量</th>
        <th>税区分</th>
        <th>税率</th>
        <th>消費税</th>
        <th>備考</th>
        <th>削除</th>
    </tr>
    <tr th:each="specification, stat : ${specifications}">
        <td>
            <input id="specificationGroupId" name="specifications[__${stat.index}__].specificationGroupId"
                   th:value="${specification.specificationGroupId}"
                   type="hidden">
            <input id="specificationId" name="specifications[__${stat.index}__].specificationId"
                   th:value="${specification.specificationId}"
                   type="hidden">
            <input id="name" name="specifications[__${stat.index}__].name"
                   th:value="${specification.name}"
                   type="text">
        </td>
        <td>
            <input id="price" name="specifications[__${stat.index}__].price"
                   th:value="${specification.price}"
                   type="number">
        </td>
        <td>
            <input id="unitId" name="specifications[__${stat.index}__].unitId"
                   th:value="${specification.unitId}"
                   type="hidden">
            <input id="unitName" name="unit.unitName"
                   th:value="${unit.unitName}"
                   type="text">
        </td>
        <td>
            <input id="quantity" name="specifications[__${stat.index}__].quantity"
                   th:value="${specification.quantity}"
                   type="number">
        </td>
        <td>
            <input id="taxTypeId" name="specifications[__${stat.index}__].taxTypeId"
                   th:value="${specification.taxTypeId}"
                   type="hidden">
            <input id="taxTypeName" name="taxType.taxTypeName"
                   th:value="${taxType.taxTypeName}"
                   type="text">
        </td>
        <td>
            <input id="taxRate" name="taxType.taxRate"
                   th:value="__${specification.price}__ * __${specification.quantity}__ * __${taxType.taxRate}__"
                   type="number">
        </td>
        <td>
            <input id="spec-memo" name="specifications[__${stat.index}__].memo"
                   th:value="${specification.memo}"
                   type="text">
        </td>
        <td>
            <input id="delete" name="delete" type="button" value="削除"
                   onclick="deleteRow(this)">
        </td>
    </tr>
</table>

<input type="submit" value="明細追加">
<input form="specification" type="submit" value="登　録">

<input id="balanceTypeId" name="balanceTypeId"
       th:value="${specificationGroupForm.balanceTypeId}"
       type="hidden">

<form id="searchShop"
      th:action="@{'/searchShop'}" method="get">
</form>
<form id="searchAccountSource"
      th:action="@{'/searchAccountSource'}" method="get">
</form>
<form id="searchAccountDestination"
      th:action="@{'/searchAccountDestination'}" method="get">
</form>

<form id="dummy"></form>
<script src="/js/createGroup.js"></script>
</body>
</html>